#!/usr/bin/env bash

if [[ ! -z "$(git status --porcelain)" ]]; then
    echo "Working directory is not clean."
    exit 1
fi

rm -f .gitignore phpunit.xml.dist symfony.lock composer.lock && \
rm -rf bin/ config/ public/ src/ var/cache var/log vendor/ && \
php -dmemory_limit=-1 "$(which composer)" update && \
git checkout -- $(git ls-files --deleted)
